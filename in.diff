7d6
<     <!-- DataTables CSS -->
39c38
<             min-height: 250px;
---
>             min-height: 700px;
70,74d68
<                 <div style="margin-left: auto;">
<                     <select id="profiles-select" style="width: 200px;"><option value="">-- 新增 DB 設定檔 --</option></select>
<                     <button id="save-profile-btn" class="btn-sm btn-success">儲存</button>
<                     <button id="delete-profile-btn" class="btn-sm btn-danger">刪除</button>
<                 </div>
96a91,95
>                 <div style="margin-left: auto;">
>                     <select id="profiles-select" style="width: 200px;"><option value="">-- 新增 DB 設定檔 --</option></select>
>                     <button id="save-profile-btn" class="btn-sm btn-success">儲存</button>
>                     <button id="delete-profile-btn" class="btn-sm btn-danger">刪除</button>
>                 </div>
142c141
<         VIEW_FORMAT_STATE: 'viewFormatState'
---
>         VIEW_FORMAT_STATE: 'viewFormatState' // <<< 修改點 1
196a196
>             //updateLocalStorageUsage();
241a242
>     // Dean added : 計算 LocalStorage SessionStorage 總量大小 MB
258a260,261
> 
>         // Dean Added : 計算 LocalStorage and SessionStorage 用量/總量
265a269
> 
268a273,275
>         // Dean added : 捲動到資料 Step 1 到狀態欄
>         //elements.sqlSection.scrollIntoView({ behavior: 'auto' });
> 
274a282
> 
279a288
>             // Dean added : 加回傳row 比數, Elapsed time in seconds 耗時秒數 
291a301,304
>             // 註解以下三行，因為格式狀態會在 initializeApp 時從 localStorage 載入
>             // viewStates.rowset.mode = 'normal';
>             // viewStates.isRowSpan = false;
>             // activeFormat = 'rowset';
292a306,307
> 
>             // Dean added : 捲動到資料 Step 2 到資料欄位, 顯示格式按鈕
293a309,311
>             //elements.sqlSection.scrollIntoView({ behavior: 'smooth' });
> 
>             // Dean added : 計算顯示 Local Storage 用量
300a319
>                 //sessionStorage.clear();
302a322
>             //elements.resultContainer.innerHTML = `<div class="result-box error">查詢失敗:${error.name} / ${error.message} </div>`;
307a328
>             
422a444,445
>             // Dean added: 手動修改datatalbe 按鈕在transpose 模式下無法顯示藍色的問題
>             updateActiveFormatButton();
523a547,549
> 
>             // Dean added: 選完sql後, 跳到 SQL 輸入格, 可直接按Tab, Space 鍵盤空白鍵查詢
>             // elements.requestQueryBtn.focus();
670a697,699
>             renderResult();
> 
>             // <<< 修改點 2 >>>
675d703
<             renderResult();
684a713,723
> 
>     const navigationEntries = window.performance.getEntriesByType("navigation");
>         if (navigationEntries[0].type === "back_forward") {
>             // alert("這是透過歷史紀錄回退的,想要避免Reload Query");
>             // return;
>         } else if (navigationEntries.length > 0 && navigationEntries[0].type === "reload") {
>             //alert("這是重新載入的");
>         } else {
>             //alert("這是第一次導航或其他類型");
>         }
>         // <<< 修改點 3 (Part 1) >>>
690a730
>         // Dean Added : 計算 LocalStorage SessionSrorage Size
692a733
>             // alert(`Local Storage 本地儲存大小 : ${totalLocalStorage} MB`);
696a738
>             // alert(`Session Storage 會話儲存大小 : ${totalSessionStorage} MB`);
700c742,744
<         if (isResultPage) {
---
> 
>         const queryDataJSON = sessionStorage.getItem(queryId);
>         if (isResultPage && queryDataJSON ) {
703d746
<             const queryDataJSON = sessionStorage.getItem(queryId);
710,712c753,757
<             elements.hostname.value = queryData.hostname;
<             elements.sid.value = queryData.sid;
<             elements.user.value = queryData.user;
---
>             Object.keys(queryData).forEach(key => {
>                 if (elements[key] && key !== 'sql') {
>                     elements[key].value = queryData[key];
>                 }
>             });
714,715d758
<             elements.dbType.value = queryData.db_type;
<             elements.port.value = queryData.port;
717c760,764
<             
---
> 
> // ----> 想要 1:不使用Session Storage, 2:回前頁也不會重新Query, 但是似乎還沒找到方法.
> // execSqlStatement = queryData.sql;
> // runQuery(queryData)
> 
720d766
<             
745c791
<         updateActiveFormatButton();
---
>         updateActiveFormatButton(); // <<< 修改點 3 (Part 2) >>>
